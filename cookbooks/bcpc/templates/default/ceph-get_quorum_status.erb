#!/bin/bash
################################################
#
#              Generated by Chef
#
################################################

DATE="`date '+%Y-%m-%d %H:%M:%S'`"
LOGFILE=/var/log/ceph/quorum_status.log

function log {
  echo "$DATE $1" >> $LOGFILE
}

OUTPUT="`ceph \
--admin-daemon=/var/run/ceph/ceph-mon.<%= node['hostname'] %>.asok \
quorum_status >/dev/stdout 2>&1`"

if [ $? -eq 0 ]; then
  OUTPUT="`echo $OUTPUT | jq -c -M '.'`"
fi
echo "$OUTPUT"
log "$OUTPUT"
