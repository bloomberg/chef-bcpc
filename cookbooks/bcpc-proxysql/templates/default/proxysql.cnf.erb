################################################
#
#              Generated by Chef
#
################################################

#file proxysql.cfg

# This config file is parsed using libconfig , and its grammar is described in:
# http://www.hyperrealm.com/libconfig/libconfig_manual.html#Configuration-File-Grammar
# Grammar is also copied at the end of this file



datadir="/var/lib/proxysql"

admin_variables=
{
<% @admin_variables.each do |key, value| %>
  <% if value.is_a?(String) %>
    <%= key %> = "<%= value %>"
  <% else %>
    <%= key %> = <%= value %>
  <% end %>
<% end %>
}

mysql_variables=
{
<% @mysql_variables.each do |key, value| %>
  <% if value.is_a?(String) %>
    <%= key %> = "<%= value %>"
  <% else %>
    <%= key %> = <%= value %>
  <% end %>
<% end %>
}


# defines all the MySQL servers
mysql_servers =
(
<% @mysql_servers.each_with_index do |server, index| %>
  {
  <% server.each do |key, value| %>
    <% if value.is_a?(String) %>
      <%= key %> = "<%= value %>"
    <% else %>
      <%= key %> = <%= value %>
    <% end %>
  <% end %>
  }<% if @mysql_servers.length != index + 1 %>,<% end %>
<% end %>
)

# defines all the MySQL users
mysql_users:
(
<% @mysql_users.each_with_index do |user, index| %>
  {
  <% user.each do |key, value| %>
    <% if value.is_a?(String) %>
      <%= key %> = "<%= value %>"
    <% else %>
      <%= key %> = <%= value %>
    <% end %>
  <% end %>
  }<% if @mysql_users.length != index + 1 %>,<% end %>
<% end %>
)

#defines MySQL Query Rules
mysql_query_rules:
(
<% @mysql_query_rules.each_with_index do |rule, index| %>
  {
  <% rule.each do |key, value| %>
    <% if value.is_a?(String) %>
      <%= key %> = "<%= value %>"
    <% else %>
      <%= key %> = <%= value %>
    <% end %>
  <% end %>
  }<% if @mysql_query_rules.length != index + 1 %>,<% end %>
<% end %>
)

